const moduleRaid=function(){moduleRaid.mID=Math.random().toString(36).substring(7),moduleRaid.mObj={};parseInt(window.Debug?.VERSION?.split(".")?.[1]);return fillModuleArray=function(){if(parseFloat(window.Debug.VERSION)<2.3)(window.webpackChunkbuild||window.webpackChunkwhatsapp_web_client).push([[moduleRaid.mID],{},function(e){Object.keys(e.m).forEach((function(t){moduleRaid.mObj[t]=e(t)}))}]);else{let e=self.require("__debug").modulesMap;Object.keys(e).filter((e=>e.includes("WA"))).forEach((function(t){let i=e[t];if(i&&(moduleRaid.mObj[t]={default:i.defaultExport,factory:i.factory,...i},0==Object.keys(moduleRaid.mObj[t].default).length))try{self.ErrorGuard.skipGuardGlobal(!0),Object.assign(moduleRaid.mObj[t],self.importNamespace(t))}catch(e){}}))}},fillModuleArray(),get=function(e){return moduleRaid.mObj[e]},findModule=function(e){return results=[],modules=Object.keys(moduleRaid.mObj),modules.forEach((function(t){if(mod=moduleRaid.mObj[t],"undefined"!=typeof mod)if("string"==typeof e){if("object"==typeof mod.default)for(key in mod.default)key==e&&results.push(mod);for(key in mod)key==e&&results.push(mod)}else{if("function"!=typeof e)throw new TypeError("findModule can only find via string and function, "+typeof e+" was passed");e(mod)&&results.push(mod)}})),results},{modules:moduleRaid.mObj,constructors:moduleRaid.cArr,findModule:findModule,get:get}};"object"==typeof module&&module.exports?module.exports=moduleRaid:window.mR=moduleRaid(),window.mR=moduleRaid(),window.compareWwebVersions=(e,t,i)=>{if(![">",">=","<","<=","="].includes(t))throw new class extends Error{constructor(e){super(e),this.name="CompareWwebVersionsError"}}("Invalid comparison operator is provided");if("string"!=typeof e||"string"!=typeof i)throw new class extends Error{constructor(e){super(e),this.name="CompareWwebVersionsError"}}("A non-string WWeb version type is provided");for(e=e.replace(/-beta$/,""),i=i.replace(/-beta$/,"");e.length!==i.length;)e.length>i.length?i=i.concat("0"):e=e.concat("0");return e=Number(e.replace(/\./g,"")),i=Number(i.replace(/\./g,"")),">"===t?e>i:">="===t?e>=i:"<"===t?e<i:"<="===t?e<=i:"="===t&&e===i},window.Store=Object.assign({},window.require("WAWebCollections")),window.Store.AppState=window.require("WAWebSocketModel").Socket,window.Store.BlockContact=window.require("WAWebBlockContactAction"),window.Store.Conn=window.require("WAWebConnModel").Conn,window.Store.Cmd=window.require("WAWebCmd").Cmd,window.Store.DownloadManager=window.require("WAWebDownloadManager").downloadManager,window.Store.GroupQueryAndUpdate=window.require("WAWebGroupQueryJob").queryAndUpdateGroupMetadataById,window.Store.MediaPrep=window.require("WAWebPrepRawMedia"),window.Store.MediaObject=window.require("WAWebMediaStorage"),window.Store.MediaTypes=window.require("WAWebMmsMediaTypes"),window.Store.MediaUpload=window.require("WAWebMediaMmsV4Upload"),window.Store.MsgKey=window.require("WAWebMsgKey"),window.Store.OpaqueData=window.require("WAWebMediaOpaqueData"),window.Store.QueryProduct=window.require("WAWebBizProductCatalogBridge"),window.Store.QueryOrder=window.require("WAWebBizOrderBridge"),window.Store.SendClear=window.require("WAWebChatClearBridge"),window.Store.SendDelete=window.require("WAWebDeleteChatAction"),window.Store.SendMessage=window.require("WAWebSendMsgChatAction"),window.Store.EditMessage=window.require("WAWebSendMessageEditAction"),window.Store.SendSeen=window.require("WAWebUpdateUnreadChatAction"),window.Store.User=window.require("WAWebUserPrefsMeUser"),window.Store.ContactMethods=window.require("WAWebContactGetters"),window.Store.UserConstructor=window.require("WAWebWid"),window.Store.Validators=window.require("WALinkify"),window.Store.WidFactory=window.require("WAWebWidFactory"),window.Store.ProfilePic=window.require("WAWebContactProfilePicThumbBridge"),window.Store.PresenceUtils=window.require("WAWebPresenceChatAction"),window.Store.ChatState=window.require("WAWebChatStateBridge"),window.Store.findCommonGroups=window.require("WAWebFindCommonGroupsContactAction").findCommonGroups,window.Store.StatusUtils=window.require("WAWebContactStatusBridge"),window.Store.ConversationMsgs=window.require("WAWebChatLoadMessages"),window.Store.sendReactionToMsg=window.require("WAWebSendReactionMsgAction").sendReactionToMsg,window.Store.createOrUpdateReactionsModule=window.require("WAWebDBCreateOrUpdateReactions"),window.Store.EphemeralFields=window.require("WAWebGetEphemeralFieldsMsgActionsUtils"),window.Store.MsgActionChecks=window.require("WAWebMsgActionCapability"),window.Store.QuotedMsg=window.require("WAWebQuotedMsgModelUtils"),window.Store.LinkPreview=window.require("WAWebLinkPreviewChatAction"),window.Store.Socket=window.require("WADeprecatedSendIq"),window.Store.SocketWap=window.require("WAWap"),window.Store.SearchContext=window.require("WAWebChatMessageSearch"),window.Store.DrawerManager=window.require("WAWebDrawerManager").DrawerManager,window.Store.LidUtils=window.require("WAWebApiContact"),window.Store.WidToJid=window.require("WAWebWidToJid"),window.Store.JidToWid=window.require("WAWebJidToWid"),window.Store.getMsgInfo=window.require("WAWebApiMessageInfoStore").queryMsgInfo,window.Store.pinUnpinMsg=window.require("WAWebSendPinMessageAction").sendPinInChatMsg,window.Store.QueryExist=window.require("WAWebQueryExistsJob").queryWidExists,window.Store.ReplyUtils=window.require("WAWebMsgReply"),window.Store.BotSecret=window.require("WAWebBotMessageSecret"),window.Store.BotProfiles=window.require("WAWebBotProfileCollection"),window.Store.ContactCollection=window.require("WAWebContactCollection").ContactCollection,window.Store.DeviceList=window.require("WAWebApiDeviceList"),window.Store.HistorySync=window.require("WAWebSendNonMessageDataRequest"),window.Store.AddonReactionTable=window.require("WAWebAddonReactionTableMode").reactionTableMode,window.Store.ChatGetters=window.require("WAWebChatGetters"),window.Store.UploadUtils=window.require("WAWebUploadManager"),window.Store.Settings={...window.require("WAWebUserPrefsGeneral"),...window.require("WAWebUserPrefsNotifications"),setPushname:window.require("WAWebSetPushnameConnAction").setPushname},window.Store.NumberInfo={...window.require("WAPhoneUtils"),...window.require("WAPhoneFindCC")},window.Store.ForwardUtils={...window.require("WAWebForwardMessagesToChat")},window.Store.VCard={...window.require("WAWebFrontendVcardUtils"),...window.require("WAWebVcardParsingUtils"),...window.require("WAWebVcardGetNameFromParsed")},window.Store.StickerTools={...window.require("WAWebImageUtils"),...window.require("WAWebAddWebpMetadata")},window.Store.GroupUtils={...window.require("WAWebGroupCreateJob"),...window.require("WAWebGroupModifyInfoJob"),...window.require("WAWebExitGroupAction"),...window.require("WAWebContactProfilePicThumbBridge")},window.Store.GroupParticipants={...window.require("WAWebModifyParticipantsGroupAction"),...window.require("WASmaxGroupsAddParticipantsRPC")},window.Store.GroupInvite={...window.require("WAWebGroupInviteJob"),...window.require("WAWebGroupQueryJob"),...window.require("WAWebMexFetchGroupInviteCodeJob")},window.Store.GroupInviteV4={...window.require("WAWebGroupInviteV4Job"),...window.require("WAWebChatSendMessages")},window.Store.MembershipRequestUtils={...window.require("WAWebApiMembershipApprovalRequestStore"),...window.require("WASmaxGroupsMembershipRequestsActionRPC")},window.Store.ChannelUtils={...window.require("WAWebLoadNewsletterPreviewChatAction"),...window.require("WAWebNewsletterMetadataQueryJob"),...window.require("WAWebNewsletterCreateQueryJob"),...window.require("WAWebEditNewsletterMetadataAction"),...window.require("WAWebNewsletterDeleteAction"),...window.require("WAWebNewsletterSubscribeAction"),...window.require("WAWebNewsletterUnsubscribeAction"),...window.require("WAWebNewsletterDirectorySearchAction"),...window.require("WAWebNewsletterToggleMuteStateJob"),...window.require("WAWebNewsletterGatingUtils"),...window.require("WAWebNewsletterModelUtils"),...window.require("WAWebMexAcceptNewsletterAdminInviteJob"),...window.require("WAWebMexRevokeNewsletterAdminInviteJob"),...window.require("WAWebChangeNewsletterOwnerAction"),...window.require("WAWebDemoteNewsletterAdminAction"),...window.require("WAWebNewsletterDemoteAdminJob"),countryCodesIso:window.require("WAWebCountriesNativeCountryNames"),currentRegion:window.require("WAWebL10N").getRegion()},window.Store.SendChannelMessage={...window.require("WAWebNewsletterUpdateMsgsRecordsJob"),...window.require("WAWebMsgDataFromModel"),...window.require("WAWebNewsletterSendMessageJob"),...window.require("WAWebNewsletterSendMsgAction"),...window.require("WAMediaCalculateFilehash")},window.Store.ChannelSubscribers={...window.require("WAWebMexFetchNewsletterSubscribersJob"),...window.require("WAWebNewsletterSubscriberListAction")},window.Store.AddressbookContactUtils={...window.require("WAWebSaveContactAction"),...window.require("WAWebDeleteContactAction")},window.Store.Chat._find&&window.Store.Chat.findImpl||(window.Store.Chat._find=e=>{const t=window.Store.Chat.get(e);return t?Promise.resolve(t):Promise.resolve({id:e})},window.Store.Chat.findImpl=window.Store.Chat._find),window.injectToFunction=(e,t)=>{const i=window.require(e.module),o=i[e.function];i[e.function]=(...e)=>t(o,...e)},window.injectToFunction({module:"WAWebBackendJobsCommon",function:"mediaTypeFromProtobuf"},((e,...t)=>{const[i]=t;return i.locationMessage?null:e(...t)})),window.injectToFunction({module:"WAWebE2EProtoUtils",function:"typeAttributeFromProtobuf"},((e,...t)=>{const[i]=t;return i.locationMessage||i.groupInviteMessage?"text":e(...t)})),window.WWebJS={},window.WWebJS.forwardMessage=async(e,t)=>{const i=window.Store.Msg.get(t)||(await window.Store.Msg.getMessagesById([t]))?.messages?.[0],o=await window.WWebJS.getChat(e,{getAsModel:!1});return window.compareWwebVersions(window.Debug.VERSION,">","2.3000.0")?window.Store.ForwardUtils.forwardMessagesToChats([i],[o],!0):o.forwardMessages([i])},window.WWebJS.sendSeen=async e=>{const t=await window.WWebJS.getChat(e,{getAsModel:!1});return!!t&&(await window.Store.SendSeen.sendSeen(t),!0)},window.WWebJS.sendMessage=async(e,t,i={})=>{const o=window.Store.ChatGetters.getIsNewsletter(e);let r={};i.media&&(r=i.sendMediaAsSticker&&!o?await window.WWebJS.processStickerData(i.media):await window.WWebJS.processMediaData(i.media,{forceSticker:i.sendMediaAsSticker,forceGif:i.sendVideoAsGif,forceVoice:i.sendAudioAsVoice,forceDocument:i.sendMediaAsDocument,forceMediaHd:i.sendMediaAsHd,sendToChannel:o}),r.caption=i.caption,t=i.sendMediaAsSticker?void 0:r.preview,r.isViewOnce=i.isViewOnce,delete i.media,delete i.sendMediaAsSticker);let n={};if(i.quotedMessageId){let t=window.Store.Msg.get(i.quotedMessageId);if(!t&&(t=(await window.Store.Msg.getMessagesById([i.quotedMessageId]))?.messages?.[0]),t){(window.Store.ReplyUtils?window.Store.ReplyUtils.canReplyMsg(t.unsafe()):t.canReply())&&(n=t.msgContextInfo(e))}else if(!i.ignoreQuoteErrors)throw new Error("Could not get the quoted message.");delete i.ignoreQuoteErrors,delete i.quotedMessageId}i.mentionedJidList&&(i.mentionedJidList=await Promise.all(i.mentionedJidList.map((async e=>{const t=window.Store.WidFactory.createWid(e);if(await window.Store.QueryExist(t))return t}))),i.mentionedJidList=i.mentionedJidList.filter(Boolean)),i.groupMentions&&(i.groupMentions=i.groupMentions.map((e=>({groupSubject:e.subject,groupJid:window.Store.WidFactory.createWid(e.id)}))));let a={};if(i.location){let{latitude:e,longitude:t,description:o,url:r}=i.location;r=window.Store.Validators.findLink(r)?.href,r&&!o&&(o=r),a={type:"location",loc:o,lat:e,lng:t,clientUrl:r},delete i.location}let d={};if(i.poll){const{pollName:e,pollOptions:t}=i.poll,{allowMultipleAnswers:o,messageSecret:r}=i.poll.options;d={kind:"pollCreation",type:"poll_creation",pollName:e,pollOptions:t,pollSelectableOptionsCount:o?0:1,messageSecret:Array.isArray(r)&&32===r.length?new Uint8Array(r):window.crypto.getRandomValues(new Uint8Array(32))},delete i.poll}let s={};if(i.contactCard){let e=window.Store.Contact.get(i.contactCard);s={body:window.Store.VCard.vcardFromContactModel(e).vcard,type:"vcard",vcardFormattedName:e.formattedName},delete i.contactCard}else if(i.contactCardList){s={type:"multi_vcard",vcardList:i.contactCardList.map((e=>window.Store.Contact.get(e))).map((e=>window.Store.VCard.vcardFromContactModel(e))),body:null},delete i.contactCardList}else if(i.parseVCards&&"string"==typeof t&&t.startsWith("BEGIN:VCARD")){delete i.parseVCards,delete i.linkPreview;try{const e=window.Store.VCard.parseVcard(t);e&&(s={type:"vcard",vcardFormattedName:window.Store.VCard.vcardGetNameFromParsed(e)})}catch(e){}}if(i.linkPreview){delete i.linkPreview;const e=window.Store.Validators.findLink(t);if(e){let t=await window.Store.LinkPreview.getLinkPreview(e);t&&t.data&&(t=t.data,t.preview=!0,t.subtype="url",i={...i,...t})}}let w={};if(i.buttons){let e;e="chat"===i.buttons.type?t=i.buttons.body:i.caption?i.caption:" ",w={productHeaderImageRejected:!1,isFromTemplate:!1,isDynamicReplyButtonsMsg:!0,title:i.buttons.title?i.buttons.title:void 0,footer:i.buttons.footer?i.buttons.footer:void 0,dynamicReplyButtons:i.buttons.buttons,replyButtons:i.buttons.buttons,caption:e},delete i.buttons}let c={};if(i.list){if("smba"===window.Store.Conn.platform||"smbi"===window.Store.Conn.platform)throw"[LT01] Whatsapp business can't send this yet";c={type:"list",footer:i.list.footer,list:{...i.list,listType:1},body:i.list.description},delete i.list,delete c.list.footer}const l={};i.invokedBotWid&&(l.messageSecret=window.crypto.getRandomValues(new Uint8Array(32)),l.botMessageSecret=await window.Store.BotSecret.genBotMsgSecretFromMsgSecret(l.messageSecret),l.invokedBotWid=window.Store.WidFactory.createWid(i.invokedBotWid),l.botPersonaId=window.Store.BotProfiles.BotProfileCollection.get(i.invokedBotWid).personaId,delete i.invokedBotWid);const u=window.Store.User.getMaybeMeLidUser(),p=window.Store.User.getMaybeMeUser(),W=await window.Store.MsgKey.newId();let S,m=e.id.isLid()?u:p;e.isGroup&&(m=e.groupMetadata&&e.groupMetadata.isLidAddressingMode?u:p,S=window.Store.WidFactory.toUserWid(m));const b=new window.Store.MsgKey({from:m,to:e.id,id:W,participant:S,selfDir:"out"}),g=i.extraOptions||{};delete i.extraOptions;const M=window.Store.EphemeralFields.getEphemeralFields(e),h={...i,id:b,ack:0,body:t,from:p,to:e.id,local:!0,self:"out",t:parseInt((new Date).getTime()/1e3),isNewMsg:!0,type:"chat",...M,...r,...r.toJSON?r.toJSON():{},...n,...a,...d,...s,...w,...c,...l,...g};if(l&&delete h.canonicalUrl,o){const t=new window.Store.Msg.modelClass(h),i=window.Store.SendChannelMessage.msgDataFromMsgModel(t),o=Object.keys(r).length>0;await window.Store.SendChannelMessage.addNewsletterMsgsRecords([i]),e.msgs.add(t),e.t=t.t;const n=await window.Store.SendChannelMessage.sendNewsletterMessageJob({msg:t,type:"chat"===h.type?"text":o?"media":"pollCreation",newsletterJid:e.id.toJid(),...o?{mediaMetadata:t.avParams(),mediaHandle:o?r.mediaHandle:null}:{}});return n.success&&(t.t=n.ack.t,t.serverId=n.serverId),t.updateAck(1,!0),await window.Store.SendChannelMessage.updateNewsletterMsgRecord(t),t}return await window.Store.SendMessage.addAndSendMsgToChat(e,h),await window.Store.HistorySync.sendPeerDataOperationRequest(3,{chatId:e.id}),window.Store.Msg.get(b._serialized)},window.WWebJS.editMessage=async(e,t,i={})=>{const o=i.extraOptions||{};if(delete i.extraOptions,i.mentionedJidList&&(i.mentionedJidList=await Promise.all(i.mentionedJidList.map((async e=>{const t=window.Store.WidFactory.createWid(e);if(await window.Store.QueryExist(t))return t}))),i.mentionedJidList=i.mentionedJidList.filter(Boolean)),i.groupMentions&&(i.groupMentions=i.groupMentions.map((e=>({groupSubject:e.subject,groupJid:window.Store.WidFactory.createWid(e.id)})))),i.linkPreview){delete i.linkPreview;const e=window.Store.Validators.findLink(t);if(e){const t=await window.Store.LinkPreview.getLinkPreview(e);t.preview=!0,t.subtype="url",i={...i,...t}}}const r={...i,...o};return await window.Store.EditMessage.sendMessageEdit(e,t,r),window.Store.Msg.get(e.id._serialized)},window.WWebJS.toStickerData=async e=>{if("image/webp"==e.mimetype)return e;const t=window.WWebJS.mediaInfoToFile(e),i=await window.Store.StickerTools.toWebpSticker(t),o=await i.arrayBuffer();return{mimetype:"image/webp",data:window.WWebJS.arrayBufferToBase64(o)}},window.WWebJS.processStickerData=async e=>{if("image/webp"!==e.mimetype)throw new Error("Invalid media type");const t=window.WWebJS.mediaInfoToFile(e);let i=await window.WWebJS.getFileHash(t),o=await window.WWebJS.generateHash(32);const r=new AbortController,n=await window.Store.UploadUtils.encryptAndUpload({blob:t,type:"sticker",signal:r.signal,mediaKey:o});return{...n,clientUrl:n.url,deprecatedMms3Url:n.url,uploadhash:n.encFilehash,size:t.size,type:"sticker",filehash:i}},window.WWebJS.processMediaData=async(e,{forceSticker:t,forceGif:i,forceVoice:o,forceDocument:r,forceMediaHd:n,sendToChannel:a})=>{const d=window.WWebJS.mediaInfoToFile(e),s=await window.Store.OpaqueData.createFromData(d,d.type),w={asSticker:t,asGif:i,isPtt:o,asDocument:r};n&&0===d.type.indexOf("image/")&&(w.maxDimension=2560);const c=window.Store.MediaPrep.prepRawMedia(s,w),l=await c.waitForPrep(),u=window.Store.MediaObject.getOrCreateMediaObject(l.filehash),p=window.Store.MediaTypes.msgToMediaType({type:l.type,isGif:l.isGif,isNewsletter:a});if(o&&"ptt"===l.type){const e=u.contentInfo.waveform;l.waveform=e||await window.WWebJS.generateWaveform(d)}l.mediaBlob instanceof window.Store.OpaqueData||(l.mediaBlob=await window.Store.OpaqueData.createFromData(l.mediaBlob,l.mediaBlob.type)),l.renderableUrl=l.mediaBlob.url(),u.consolidate(l.toJSON()),l.mediaBlob.autorelease();const W={mimetype:l.mimetype,mediaObject:u,mediaType:p,...a?{calculateToken:window.Store.SendChannelMessage.getRandomFilehash}:{}},S=(a?await window.Store.MediaUpload.uploadUnencryptedMedia(W):await window.Store.MediaUpload.uploadMedia(W)).mediaEntry;if(!S)throw new Error("upload failed: media entry was not created");return l.set({clientUrl:S.mmsUrl,deprecatedMms3Url:S.deprecatedMms3Url,directPath:S.directPath,mediaKey:S.mediaKey,mediaKeyTimestamp:S.mediaKeyTimestamp,filehash:u.filehash,encFilehash:S.encFilehash,uploadhash:S.uploadHash,size:u.size,streamingSidecar:S.sidecar,firstFrameSidecar:S.firstFrameSidecar,mediaHandle:a?S.handle:null}),l},window.WWebJS.getMessageModel=e=>{const t=e.serialize();return t.isEphemeral=e.isEphemeral,t.isStatusV3=e.isStatusV3,t.links=window.Store.Validators.findLinks(e.mediaObject?e.caption:e.body).map((e=>({link:e.href,isSuspicious:Boolean(e.suspiciousCharacters&&e.suspiciousCharacters.size)}))),t.buttons&&(t.buttons=t.buttons.serialize()),t.dynamicReplyButtons&&(t.dynamicReplyButtons=JSON.parse(JSON.stringify(t.dynamicReplyButtons))),t.replyButtons&&(t.replyButtons=JSON.parse(JSON.stringify(t.replyButtons))),"object"==typeof t.id.remote&&(t.id=Object.assign({},t.id,{remote:t.id.remote._serialized})),delete t.pendingAckUpdate,t},window.WWebJS.getPollVoteModel=async e=>{const t=e.serialize();if(!e.parentMsgKey)return null;const i=window.Store.Msg.get(e.parentMsgKey)||(await window.Store.Msg.getMessagesById([e.parentMsgKey]))?.messages?.[0];return i&&(t.parentMessage=window.WWebJS.getMessageModel(i)),t},window.WWebJS.getChat=async(e,{getAsModel:t=!0}={})=>{const i=/@\w*newsletter\b/.test(e),o=window.Store.WidFactory.createWid(e);let r;if(i)try{r=window.Store.NewsletterCollection.get(e),r||(await window.Store.ChannelUtils.loadNewsletterPreviewChat(e),r=await window.Store.NewsletterCollection.find(o))}catch(e){r=null}else r=window.Store.Chat.get(o)||await window.Store.Chat.find(o);return t&&r?await window.WWebJS.getChatModel(r,{isChannel:i}):r},window.WWebJS.getChannelMetadata=async e=>{const t=await window.Store.ChannelUtils.queryNewsletterMetadataByInviteCode(e,window.Store.ChannelUtils.getRoleByIdentifier(e)),i=t.newsletterPictureMetadataMixin?.picture[0]?.queryPictureDirectPathOrEmptyResponseMixinGroup.value.directPath;return{id:t.idJid,createdAtTs:t.newsletterCreationTimeMetadataMixin.creationTimeValue,titleMetadata:{title:t.newsletterNameMetadataMixin.nameElementValue,updatedAtTs:t.newsletterNameMetadataMixin.nameUpdateTime},descriptionMetadata:{description:t.newsletterDescriptionMetadataMixin.descriptionQueryDescriptionResponseMixin.elementValue,updatedAtTs:t.newsletterDescriptionMetadataMixin.descriptionQueryDescriptionResponseMixin.updateTime},inviteLink:`https://whatsapp.com/channel/${t.newsletterInviteLinkMetadataMixin.inviteCode}`,membershipType:window.Store.ChannelUtils.getRoleByIdentifier(e),stateType:t.newsletterStateMetadataMixin.stateType,pictureUrl:i?`https://pps.whatsapp.net${i}`:null,subscribersCount:t.newsletterSubscribersMetadataMixin.subscribersCount,isVerified:"verified"===t.newsletterVerificationMetadataMixin.verificationState}},window.WWebJS.getChats=async()=>{const e=window.Store.Chat.getModelsArray().map((e=>window.WWebJS.getChatModel(e)));return await Promise.all(e)},window.WWebJS.getChannels=async()=>{const e=window.Store.NewsletterCollection.getModelsArray(),t=e?.map((e=>window.WWebJS.getChatModel(e,{isChannel:!0})));return await Promise.all(t)},window.WWebJS.getChatModel=async(e,{isChannel:t=!1}={})=>{if(!e)return null;const i=e.serialize();if(i.isGroup=!1,i.isMuted=0!==e.mute?.expiration,t?i.isChannel=window.Store.ChatGetters.getIsNewsletter(e):i.formattedTitle=e.formattedTitle,e.groupMetadata){i.isGroup=!0;const t=window.Store.WidFactory.createWid(e.id._serialized);await window.Store.GroupMetadata.update(t),e.groupMetadata.participants._models.filter((e=>e.id?._serialized?.endsWith("@lid"))).forEach((e=>e.contact?.phoneNumber&&(e.id=e.contact.phoneNumber))),i.groupMetadata=e.groupMetadata.serialize(),i.isReadOnly=e.groupMetadata.announce}if(e.newsletterMetadata&&(await window.Store.NewsletterMetadataCollection.update(e.id),i.channelMetadata=e.newsletterMetadata.serialize(),i.channelMetadata.createdAtTs=e.newsletterMetadata.creationTime),i.lastMessage=null,i.msgs&&i.msgs.length){const t=e.lastReceivedKey?window.Store.Msg.get(e.lastReceivedKey._serialized)||(await window.Store.Msg.getMessagesById([e.lastReceivedKey._serialized]))?.messages?.[0]:null;t&&(i.lastMessage=window.WWebJS.getMessageModel(t))}return delete i.msgs,delete i.msgUnsyncedButtonReplyMsgs,delete i.unsyncedButtonReplies,i},window.WWebJS.getContactModel=e=>{let t=e.serialize();return t.isBusiness=void 0!==e.isBusiness&&e.isBusiness,e.businessProfile&&(t.businessProfile=e.businessProfile.serialize()),t.isMe=window.Store.ContactMethods.getIsMe(e),t.isUser=window.Store.ContactMethods.getIsUser(e),t.isGroup=window.Store.ContactMethods.getIsGroup(e),t.isWAContact=window.Store.ContactMethods.getIsWAContact(e),t.isMyContact=window.Store.ContactMethods.getIsMyContact(e),t.isBlocked=e.isContactBlocked,t.userid=window.Store.ContactMethods.getUserid(e),t.isEnterprise=window.Store.ContactMethods.getIsEnterprise(e),t.verifiedName=window.Store.ContactMethods.getVerifiedName(e),t.verifiedLevel=window.Store.ContactMethods.getVerifiedLevel(e),t.statusMute=window.Store.ContactMethods.getStatusMute(e),t.name=window.Store.ContactMethods.getName(e),t.shortName=window.Store.ContactMethods.getShortName(e),t.pushname=window.Store.ContactMethods.getPushname(e),t},window.WWebJS.getContact=async e=>{const t=window.Store.WidFactory.createWid(e);let i=await window.Store.Contact.find(t);i.id._serialized.endsWith("@lid")&&(i.id=i.phoneNumber);const o=await window.Store.BusinessProfile.fetchBizProfile(t);return o.profileOptions&&(i.businessProfile=o),window.WWebJS.getContactModel(i)},window.WWebJS.getContacts=()=>window.Store.Contact.getModelsArray().map((e=>window.WWebJS.getContactModel(e))),window.WWebJS.mediaInfoToFile=({data:e,mimetype:t,filename:i})=>{const o=window.atob(e),r=new ArrayBuffer(o.length),n=new Uint8Array(r);for(let e=0;e<o.length;e++)n[e]=o.charCodeAt(e);const a=new Blob([r],{type:t});return new File([a],i,{type:t,lastModified:Date.now()})},window.WWebJS.arrayBufferToBase64=e=>{let t="";const i=new Uint8Array(e),o=i.byteLength;for(let e=0;e<o;e++)t+=String.fromCharCode(i[e]);return window.btoa(t)},window.WWebJS.arrayBufferToBase64Async=e=>new Promise(((t,i)=>{const o=new Blob([e],{type:"application/octet-stream"}),r=new FileReader;r.onload=()=>{const[,e]=r.result.split(",");t(e)},r.onerror=e=>i(e),r.readAsDataURL(o)})),window.WWebJS.getFileHash=async e=>{let t=await e.arrayBuffer();const i=await crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode(...new Uint8Array(i)))},window.WWebJS.generateHash=async e=>{for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)t+=i.charAt(Math.floor(62*Math.random()));return t},window.WWebJS.generateWaveform=async e=>{try{const t=await e.arrayBuffer(),i=new AudioContext,o=(await i.decodeAudioData(t)).getChannelData(0),r=64,n=Math.floor(o.length/r),a=[];for(let e=0;e<r;e++){const t=n*e;let i=0;for(let e=0;e<n;e++)i+=Math.abs(o[t+e]);a.push(i/n)}const d=Math.pow(Math.max(...a),-1),s=a.map((e=>e*d));return new Uint8Array(s.map((e=>Math.floor(100*e))))}catch(e){return}},window.WWebJS.sendClearChat=async e=>{let t=await window.WWebJS.getChat(e,{getAsModel:!1});return void 0!==t&&(await window.Store.SendClear.sendClear(t,!1),!0)},window.WWebJS.sendDeleteChat=async e=>{let t=await window.WWebJS.getChat(e,{getAsModel:!1});return void 0!==t&&(await window.Store.SendDelete.sendDelete(t),!0)},window.WWebJS.sendChatstate=async(e,t)=>{switch(t=window.Store.WidFactory.createWid(t),e){case"typing":await window.Store.ChatState.sendChatStateComposing(t);break;case"recording":await window.Store.ChatState.sendChatStateRecording(t);break;case"stop":await window.Store.ChatState.sendChatStatePaused(t);break;default:throw"Invalid chatstate"}return!0},window.WWebJS.getLabelModel=e=>{let t=e.serialize();return t.hexColor=e.hexColor,t},window.WWebJS.getLabels=()=>window.Store.Label.getModelsArray().map((e=>window.WWebJS.getLabelModel(e))),window.WWebJS.getLabel=e=>{const t=window.Store.Label.get(e);return window.WWebJS.getLabelModel(t)},window.WWebJS.getChatLabels=async e=>((await window.WWebJS.getChat(e)).labels||[]).map((e=>window.WWebJS.getLabel(e))),window.WWebJS.getOrderDetail=async(e,t,i)=>{const o=window.Store.WidFactory.createWid(i);return window.Store.QueryOrder.queryOrder(o,e,80,80,t)},window.WWebJS.getProductMetadata=async e=>{let t=window.Store.Conn.wid,i=await window.Store.QueryProduct.queryProduct(t,e);if(i&&i.data)return i.data},window.WWebJS.rejectCall=async(e,t)=>{e=e.split("@")[0]+"@s.whatsapp.net";let i=window.Store.User.getMaybeMeUser().user+"@s.whatsapp.net";const o=window.Store.SocketWap.wap("call",{id:window.Store.SocketWap.generateId(),from:window.Store.SocketWap.USER_JID(i),to:window.Store.SocketWap.USER_JID(e)},[window.Store.SocketWap.wap("reject",{"call-id":t,"call-creator":window.Store.SocketWap.USER_JID(e),count:"0"})]);await window.Store.Socket.deprecatedCastStanza(o)},window.WWebJS.cropAndResizeImage=async(e,t={})=>{if(!e.mimetype.includes("image"))throw new Error("Media is not an image");t.mimetype&&!t.mimetype.includes("image")&&delete t.mimetype,t=Object.assign({size:640,mimetype:e.mimetype,quality:.75,asDataUrl:!1},t);const i=await new Promise(((t,i)=>{const o=new Image;o.onload=()=>t(o),o.onerror=i,o.src=`data:${e.mimetype};base64,${e.data}`})),o=Math.min(i.width,i.height),r=Math.floor((i.width-o)/2),n=Math.floor((i.height-o)/2),a=document.createElement("canvas");a.width=t.size,a.height=t.size;a.getContext("2d").drawImage(i,r,n,o,o,0,0,t.size,t.size);const d=a.toDataURL(t.mimetype,t.quality);return t.asDataUrl?d:Object.assign(e,{mimetype:t.mimeType,data:d.replace(`data:${t.mimeType};base64,`,"")})},window.WWebJS.setPicture=async(e,t)=>{const i=await window.WWebJS.cropAndResizeImage(t,{asDataUrl:!0,mimetype:"image/jpeg",size:96}),o=await window.WWebJS.cropAndResizeImage(t,{asDataUrl:!0,mimetype:"image/jpeg",size:640}),r=window.Store.WidFactory.createWid(e);try{const t=window.Store.ProfilePicThumb.get(e)||await window.Store.ProfilePicThumb.find(e);if(!t?.canSet())return!1;const n=await window.Store.GroupUtils.sendSetPicture(r,i,o);return!!n&&200===n.status}catch(e){if("ServerStatusCodeError"===e.name)return!1;throw e}},window.WWebJS.deletePicture=async e=>{const t=window.Store.WidFactory.createWid(e);try{if(!window.Store.ProfilePicThumb.get(e).canDelete())return;const i=await window.Store.GroupUtils.requestDeletePicture(t);return!!i&&200===i.status}catch(e){if("ServerStatusCodeError"===e.name)return!1;throw e}},window.WWebJS.getProfilePicThumbToBase64=async e=>{const t=await window.Store.ProfilePicThumb.find(e);if(t?.img)try{const e=await fetch(t.img);if(e.ok){const t=await e.blob();if(t){const e=await(e=>new Promise((t=>{const i=new FileReader;i.onloadend=function(){const e=i.result;if(null==e)t(void 0);else{const i=e.toString().split(",")[1];t(i)}},i.readAsDataURL(e)})))(t);return e}}}catch(e){}},window.WWebJS.getAddParticipantsRpcResult=async(e,t,i)=>{const o=e?.isLidAddressingMode?{phoneNumber:i,lid:window.Store.LidUtils.getCurrentLid(i)}:{phoneNumber:i},r=window.Store.WidToJid.widToGroupJid(t),n=o.lid?[{participantJid:window.Store.WidToJid.widToUserJid(o.lid),phoneNumberMixinArgs:{anyPhoneNumber:window.Store.WidToJid.widToUserJid(o.phoneNumber)}}]:[{participantJid:window.Store.WidToJid.widToUserJid(o.phoneNumber)}];let a,d;const s=window.compareWwebVersions(window.Debug.VERSION,"<=","2.2335.9"),w={name:void 0,code:void 0,inviteV4Code:void 0,inviteV4CodeExp:void 0};try{a=await window.Store.GroupParticipants.sendAddParticipantsRPC({participantArgs:n,iqTo:r}),d=s?a.value.addParticipant[0].addParticipantsParticipantMixins:a.value.addParticipant[0].addParticipantsParticipantAddedOrNonRegisteredWaUserParticipantErrorLidResponseMixinGroup.value.addParticipantsParticipantMixins}catch(e){return w.code=400,w}if("AddParticipantsResponseSuccess"===a.name){const e=d?.value.error||"200";w.name=d?.name,w.code=+e,w.inviteV4Code=d?.value.addRequestCode,w.inviteV4CodeExp=d?.value.addRequestExpiration?.toString()}else if("AddParticipantsResponseClientError"===a.name){const{code:e}=a.value.errorAddParticipantsClientErrors.value;w.code=+e}else if("AddParticipantsResponseServerError"===a.name){const{code:e}=a.value.errorServerErrors.value;w.code=+e}return w},window.WWebJS.membershipRequestAction=async(e,t,i,o)=>{const r=window.Store.WidFactory.createWid(e),n=await window.Store.Chat.find(r),a="Approve"===t;let d,s,w=[];if(await window.Store.GroupQueryAndUpdate({id:e}),i?.length?(!Array.isArray(i)&&(i=[i]),d=i.map((e=>window.Store.WidFactory.createWid(e)))):d=n.groupMetadata.membershipApprovalRequests._models.map((({id:e})=>e)),!d.length)return[];const c=d.map((e=>({participantArgs:[{participantJid:window.Store.WidToJid.widToUserJid(e)}]}))),l=window.Store.WidToJid.widToGroupJid(r),u=e=>!Array.isArray(e)||2===e.length&&e[0]===e[1]?e:1===e.length?e[0]:(e[1]-e[0]<100&&(e[0]=e[1])&&(e[1]+=100),Math.floor(Math.random()*(e[1]-e[0]+1))+e[0]),p={default:`An unknown error occupied while ${a?"approving":"rejecting"} the participant membership request`,400:"ParticipantNotFoundError",401:"ParticipantNotAuthorizedError",403:"ParticipantForbiddenError",404:"ParticipantRequestNotFoundError",408:"ParticipantTemporarilyBlockedError",409:"ParticipantConflictError",412:"ParticipantParentLinkedGroupsResourceConstraintError",500:"ParticipantResourceConstraintError"};try{for(const e of c){if(s=await window.Store.MembershipRequestUtils.sendMembershipRequestsActionRPC({iqTo:l,[a?"approveArgs":"rejectArgs"]:e}),"MembershipRequestsActionResponseSuccess"===s.name){const e=a?s.value.membershipRequestsActionApprove:s.value.membershipRequestsActionReject;if(e?.participant){const[t]=e.participant.map((t=>{const i=a?e.participant[0].membershipRequestsActionAcceptParticipantMixins?.value.error:e.participant[0].membershipRequestsActionRejectParticipantMixins?.value.error;return{requesterId:window.Store.WidFactory.createWid(t.jid)._serialized,...i?{error:+i,message:p[i]||p.default}:{message:(a?"Approved":"Rejected")+" successfully"}}}));t&&w.push(t)}}else w.push({requesterId:window.Store.JidToWid.userJidToUserWid(e.participantArgs[0].participantJid)._serialized,message:"ServerStatusCodeError"});o&&c.length>1&&c.indexOf(e)!==c.length-1&&await new Promise((e=>setTimeout(e,u(o))))}return w}catch(e){return[]}},window.WWebJS.subscribeToUnsubscribeFromChannel=async(e,t,i={})=>{const o=await window.WWebJS.getChat(e,{getAsModel:!1});if(!o||"owner"===o.newsletterMetadata.membershipType)return!1;i={eventSurface:3,deleteLocalModels:i.deleteLocalModels??!0};try{if("Subscribe"===t)await window.Store.ChannelUtils.subscribeToNewsletterAction(o,i);else{if("Unsubscribe"!==t)return!1;await window.Store.ChannelUtils.unsubscribeFromNewsletterAction(o,i)}return!0}catch(e){if("ServerStatusCodeError"===e.name)return!1;throw e}},window.WWebJS.pinUnpinMsgAction=async(e,t,i)=>{const o=window.Store.Msg.get(e)||(await window.Store.Msg.getMessagesById([e]))?.messages?.[0];if(!o)return!1;return"OK"===(await window.Store.pinUnpinMsg(o,t,i)).messageSendResult},window.WWebJS.getStatusModel=e=>{const t=e.serialize();return delete t._msgs,t},window.WWebJS.getAllStatuses=()=>window.Store.Status.getModelsArray().map((e=>window.WWebJS.getStatusModel(e))),window.WWebJS.checkNumberStatus=async e=>{try{const t=window.Store.WidFactory.createWid(e);return!!(await Store.QueryExist(t)).wid}catch(e){return!1}},window.WWebJS.sendMessageToId=async(e,t)=>{try{if(!await window.WWebJS.checkNumberStatus(e))return!1;const i=window.Store.WidFactory.createWid(e),o=await window.Store.Chat.find(i);await window.WWebJS.sendMessage(o,t);return!0}catch(e){return!1}},window.WWebJS.sendMediaMessage=async(e,t,i,o,r={})=>{try{if(!await window.WWebJS.checkNumberStatus(t))return!1;const r=window.Store.WidFactory.createWid(t),n=await window.Store.Chat.find(r),a=e.split(",");let d=a[0].match(/(?:data:)?(.*?)(?:;base64)?$/i)[1];d=d.split(/\s+;\s+/).join("; ");let s={media:{data:a[1],mimetype:d,filename:i},sendMediaAsSticker:!1,sendAudioAsVoice:!1,sendMediaAsDocument:!1,sendVideoAsGif:!1,sendMediaAsHd:!1};await window.WWebJS.sendMessage(n,o,s);return!0}catch(e){return!1}},window.WWebJS.isReady=()=>!0,window.WWebJS.getAllGroups=async e=>{const t=await window.Store.GroupMetadata.getModelsArray().map((e=>({id:e.id,name:e.subject})));return void 0!==e&&e(t),t},window.WWebJS.getGroupParticipantIDs=async(e,t)=>{const i=await window.Store.GroupMetadata.find(e),o=await i.participants._models.map((e=>({phone:e.id.user,name:e.contact.name||e.contact.verifiedName||e.contact.pushname||e.contact.shortName||e.contact.displayName||e.contact.username||e.id.user})));return null!=t&&t(o),o},window.WWebJS.getAllContacts=async e=>{const t=await Store.Contact._models.filter((e=>"c.us"==e.id.server)).map((e=>({phone:e.id.user,name:e.name||e.verifiedName||e.pushname||e.id.user})));return null!=e&&e(t),t},window.WAPI={},window.WAPI.isBusiness=function(){return Store.Conn.isSMB},window.WAPI.sendMessageToID1=async(e,t)=>await WWebJS.sendMessageToId(e,t),window.WAPI.sendImageToID=async(e,t,i,o)=>await WWebJS.sendMediaMessage(e,t,i,o),window.WAPI.checkNumberStatus=async e=>!!await window.WWebJS.checkNumberStatus(e)&&{numberExists:!0};
